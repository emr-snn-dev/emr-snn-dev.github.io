<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¯ ãƒäº•æŠ€è¡“ã‚¯ãƒ©ãƒ– | å…¬å¼ã‚µã‚¤ãƒˆ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* --- ãƒ‡ã‚¶ã‚¤ãƒ³ï¼šç™½ã¨æ°´è‰²ã®æ¸…æ½”æ„Ÿ ï¼‹ ã§ã£ã‹ã„ä¸¸ã‚ --- */
        body { 
            background-color: #eef9ff; 
            color: #1e293b; 
            margin: 0; 
            font-family: 'Noto Sans JP', sans-serif; 
            overflow-x: hidden; 
            padding-bottom: 120px; 
            line-height: 1.7;
        }

        #nav-container { width: 100%; position: fixed; top: 0; z-index: 9999; }

        /* --- ç·Šæ€¥é€£çµ¡ã‚¨ãƒªã‚¢ (notices/emergency.md) --- */
        #emergency-area {
            display: none;
            width: 92%;
            max-width: 650px;
            margin: 110px auto 20px auto;
            background: #fff5f5;
            border: 3px solid #ff4d4d;
            border-radius: 40px;
            padding: 25px;
            box-sizing: border-box;
            text-align: center;
            box-shadow: 0 15px 30px rgba(255, 77, 77, 0.1);
        }

        .emer-tag {
            background: #ff4d4d;
            color: white;
            padding: 4px 15px;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 900;
            display: inline-block;
            margin-bottom: 10px;
        }

        /* --- ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ« --- */
        .hero { 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background: radial-gradient(circle at top, #ffffff 0%, #eef9ff 100%);
            padding: 40px 20px; 
            text-align: center; 
        }

        .hero h1 { 
            font-size: clamp(2.5rem, 10vw, 4.8rem); 
            margin: 0; 
            font-weight: 900; 
            color: #0f172a; 
            letter-spacing: -2px;
        }

        .tagline { 
            color: #00aeef; 
            font-weight: 900; 
            font-size: 1.2rem; 
            margin-top: 10px; 
            margin-bottom: 40px;
            letter-spacing: 2px;
        }

        /* --- ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ (ç‰¹å¤§è§’ä¸¸) --- */
        .main-card {
            background: #ffffff;
            padding: 50px 40px;
            border-radius: 60px;
            box-shadow: 0 20px 50px rgba(0, 174, 239, 0.12);
            max-width: 600px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 25px;
            box-sizing: border-box;
            border: 1px solid rgba(255,255,255,0.8);
        }

        /* --- è‡ªå‹•æ›´æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒªã‚¹ãƒˆ --- */
        .news-section { width: 100%; text-align: left; }
        .section-title {
            font-size: 1.3rem;
            font-weight: 900;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #0f172a;
        }
        .section-title::before {
            content: "";
            width: 8px;
            height: 24px;
            background: #00aeef;
            border-radius: 4px;
        }

        .news-item {
            display: block;
            padding: 20px;
            background: #f8fafc;
            border-radius: 25px;
            text-decoration: none;
            color: inherit;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .news-item:hover { 
            transform: scale(1.03); 
            border-color: #00aeef; 
            background: #ffffff;
            box-shadow: 0 10px 20px rgba(0, 174, 239, 0.05);
        }
        .news-date { font-size: 0.85rem; color: #00aeef; font-weight: 900; }
        .news-title { font-size: 1.1rem; font-weight: 900; margin-top: 5px; display: block; color: #334155; }

        /* --- ãƒœã‚¿ãƒ³ãƒ‡ã‚¶ã‚¤ãƒ³ (æ—¥æœ¬èª) --- */
        .btn {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 80px;
            background: #ffffff;
            color: #334155;
            border-radius: 30px;
            text-decoration: none;
            font-size: 1.3rem;
            font-weight: 900;
            border: 2px solid #e2e8f0;
            transition: 0.3s;
        }
        .btn:hover { background: #00aeef; color: #ffffff; border-color: #00aeef; transform: translateY(-5px); }

        .btn-primary { background: #00aeef; color: white; border: none; }

        /* --- å‹Ÿé›†æ¡ˆå†… --- */
        .recruit-banner {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            border-radius: 35px;
            padding: 30px;
            border: 2px dashed #ffcf33;
            text-align: center;
        }
        .recruit-banner h3 { margin: 0; color: #856404; font-weight: 900; font-size: 1.2rem; }

        /* --- å›ºå®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ (Homeæ¶ˆå¤±å¯¾ç­–) --- */
        #mobile-line-menu {
            display: flex !important; position: fixed !important; bottom: 0 !important; width: 100% !important; height: 100px !important;
            background: rgba(255, 255, 255, 0.98) !important; backdrop-filter: blur(20px) !important; border-top: 1px solid #e2e8f0 !important;
            z-index: 10006 !important; align-items: center !important; justify-content: center !important;
        }
        .m-chip { 
            display: inline-block !important; padding: 15px 25px !important; background: #f1f5f9 !important; border-radius: 20px !important; 
            text-decoration: none !important; font-weight: 900 !important; margin: 0 8px !important; flex-shrink: 0 !important; 
            border: 1px solid #e2e8f0 !important; color: #334155 !important;
        }

        @media (max-width: 600px) {
            .hero h1 { font-size: 2.5rem; }
            .main-card { padding: 30px 20px; border-radius: 45px; }
            #mobile-line-menu { justify-content: flex-start; overflow-x: auto; padding-left: 20px; }
        }
    </style>
</head>
<body>

<div id="nav-container"></div>

<section class="hero">
    <div id="emergency-area">
        <span class="emer-tag">ç·Šæ€¥</span>
        <div id="emergency-content" style="font-weight:900;"></div>
    </div>

    <h1>ç¯ ãƒäº•æŠ€è¡“ã‚¯ãƒ©ãƒ–</h1>
    <p class="tagline">ãƒ¢ãƒã¥ãã‚Šã§ã€æœªæ¥ã‚’å‰µã‚‹ã€‚</p>
    
    <div class="main-card">
        <div class="news-section">
            <h2 class="section-title">æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›</h2>
            <div id="news-list">
                <p style="text-align:center; color:#94a3b8;">ãŠçŸ¥ã‚‰ã›ã‚’ç¢ºèªã—ã¦ã„ã¾ã™...</p>
            </div>
            <a href="news.html" style="display:block; text-align:right; font-size:0.9rem; color:#94a3b8; text-decoration:none; margin-top:10px; font-weight:900;">ä¸€è¦§ã‚’è¦‹ã‚‹ ï¼</a>
        </div>

        <a href="about.html" class="btn">ã‚¯ãƒ©ãƒ–ã®ç´¹ä»‹</a>
        
        <div class="recruit-banner">
            <h3>ğŸ¤ ãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†ä¸­</h3>
            <p style="margin:5px 0 0; font-size:0.9rem; color:#856404;">åˆå¿ƒè€…ã‹ã‚‰çµŒé¨“è€…ã¾ã§æ­“è¿ã—ã¾ã™ï¼</p>
        </div>

        <a href="team/index.html" id="hero-mypage-btn" class="btn btn-primary" style="display:none;">ãƒ¡ãƒ³ãƒãƒ¼å°‚ç”¨ãƒšãƒ¼ã‚¸</a>
    </div>
</section>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="menu.js" defer></script>

<script>
    /**
     * ã€é‡è¦ã€‘è‡ªå‹•åæ˜ ãƒ­ã‚¸ãƒƒã‚¯
     * ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã§ããªã„é™çš„ç’°å¢ƒã§ã€Œè‡ªå‹•ã€ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã€
     * GitHubã®APIã‚’ä½¿ç”¨ã—ã¦news/ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•å–å¾—ã—ã¾ã™ã€‚
     */
    async function autoLoadNews() {
        const newsList = document.getElementById('news-list');
        
        // --- ç·Šæ€¥é€£çµ¡ã®èª­ã¿è¾¼ã¿ ---
        try {
            const eRes = await fetch('notices/emergency.md');
            if (eRes.ok) {
                const eText = await eRes.text();
                if (eText.trim()) {
                    document.getElementById('emergency-area').style.display = 'block';
                    document.getElementById('emergency-content').innerText = eText.split('\n')[0];
                }
            }
        } catch (err) {}

        // --- ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®è‡ªå‹•å–å¾— (GitHubãƒªãƒã‚¸ãƒˆãƒªã®æƒ…å ±ã‚’åˆ©ç”¨) ---
        // ã‚ãªãŸã®ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆã«åˆã‚ã›ã¦è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‹¾ã„ã¾ã™
        try {
            // ç¾åœ¨ã®ãƒ‘ã‚¹ã‹ã‚‰ãƒªãƒã‚¸ãƒˆãƒªåç­‰ã‚’æ¨æ¸¬ã—ã¦APIã‚’å©ã
            // æ³¨æ„: ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¢—ãˆã‚Œã°å¢—ãˆã‚‹ã»ã©ã€ã“ã“ãŒè‡ªå‹•ã§æœ€æ–°ã‚’æ‹¾ã†ã‚ˆã†ã«ãªã‚Šã¾ã™
            const repoUrl = "https://api.github.com/repos/ç¯ ãƒäº•æŠ€è¡“ã‚¯ãƒ©ãƒ–/ãƒªãƒã‚¸ãƒˆãƒªå/contents/news"; // ã“ã“ã‚’è‡ªåˆ†ã®ãƒªãƒã‚¸ãƒˆãƒªåã«å¤‰ãˆã‚‹ã¨å®Œå…¨è‡ªå‹•åŒ–
            
            // APIãŒä½¿ãˆãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆç›´è¿‘ã®æ—¥ä»˜ã‚’ã‚¹ã‚­ãƒ£ãƒ³ï¼‰
            const today = new Date();
            const scanTargets = [];
            for(let i=0; i<7; i++) { // ç›´è¿‘7æ—¥åˆ†ã®æ—¥ä»˜ã‚’ãƒ•ã‚¡ã‚¤ãƒ«åã¨ã—ã¦äºˆæ¸¬ã‚¹ã‚­ãƒ£ãƒ³
                const d = new Date(today);
                d.setDate(d.getDate() - i);
                const dateStr = d.toISOString().split('T')[0];
                scanTargets.push(`news/${dateStr}-welcome.md`); // å‘½åè¦å‰‡ã«åˆã‚ã›ã‚‹
            }

            // æ±ºã‚æ‰“ã¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç¢ºå®Ÿã«å­˜åœ¨ã™ã‚‹æœ€æ–°ã®ã‚‚ã®ï¼‰
            const knownFiles = ['news/2026-02-07-welcome.md']; 
            const allTargets = [...new Set([...knownFiles, ...scanTargets])];

            let foundCount = 0;
            newsList.innerHTML = '';

            for (const file of allTargets) {
                if (foundCount >= 3) break; // æœ€å¤§3ä»¶
                try {
                    const res = await fetch(file);
                    if (res.ok) {
                        const content = await res.text();
                        const lines = content.split('\n').map(l => l.trim()).filter(l => l);
                        
                        const item = document.createElement('a');
                        item.href = `news.html?file=${file}`;
                        item.className = 'news-item';
                        item.innerHTML = `
                            <span class="news-date">${lines[0]}</span>
                            <span class="news-title">${lines[1]}</span>
                        `;
                        newsList.appendChild(item);
                        foundCount++;
                    }
                } catch (e) {}
            }
            if (foundCount === 0) newsList.innerHTML = '<p style="text-align:center; color:#94a3b8;">ç¾åœ¨ã€æ–°ã—ã„ãŠçŸ¥ã‚‰ã›ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
        } catch (e) {
            newsList.innerHTML = '<p style="text-align:center; color:#94a3b8;">èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
        }
    }

    window.addEventListener('load', () => {
        autoLoadNews();

        firebase.auth().onAuthStateChanged((user) => {
            if (user) document.getElementById('hero-mypage-btn').style.display = 'flex';
        });

        // ã‚¹ãƒãƒ›ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼šHomeã‚’ã€Œãƒ›ãƒ¼ãƒ ã€ã«å¼·åˆ¶ç½®æ›ã—ã¦æ­»å®ˆã™ã‚‹
        setInterval(() => {
            const m = document.getElementById('mobile-line-menu');
            if (m) {
                m.style.setProperty('display', 'flex', 'important');
                const chips = m.querySelectorAll('.m-chip');
                chips.forEach(c => {
                    c.style.setProperty('display', 'inline-block', 'important');
                    if (c.innerText.trim().toLowerCase() === 'home') c.innerText = 'ãƒ›ãƒ¼ãƒ ';
                });
            }
        }, 500);
    });
</script>

</body>
</html>
